<section fxLayout="row wrap" fxLayoutAlign="center center">
    <mat-card fxFlex="100%" fxFlex.xs="100%">
        <mat-card-title>Create a new order</mat-card-title>
        <form [formGroup]="orderForm" autocomplete="off" novalidate (ngSubmit)="createOrder(orderForm.value)"
            fxLayout="column wrap" fxLayoutAlign="center center" fxLayoutGap="10px">
            <mat-card-content>
                <fieldset>
                    <legend>Customer</legend>
                    <mat-form-field appearance="fill">
                        <mat-label>Customer</mat-label>
                        <mat-select formControlName="customer" id="customer" (selectionChange)="loadNif($event.value)"
                            required>
                            <mat-option *ngFor="let customer of customers" [value]="customer.id">
                                {{customer.tradeName}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="hasError('customer', 'required')"> Customer is required </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>NIF</mat-label>
                        <input matInput type="text" placeholder="NIF" formControlName="nif" id="nif" required>
                    </mat-form-field>
                </fieldset>

                <fieldset>
                    <legend>Employee (optional)</legend>
                    <mat-form-field appearance="fill">
                        <mat-label>Employee</mat-label>
                        <mat-select formControlName="employee" id="employee" (selectionChange)="loadDni($event.value)" required>
                            <mat-option *ngFor="let employee of employees" [value]="employee.id">
                                {{employee.name}} - {{employee.dni}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="hasError('employee', 'required')"> Employee is required </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>DNI</mat-label>
                        <input matInput type="text" placeholder="DNI" formControlName="dni" id="dni" required>
                    </mat-form-field>
                </fieldset>

                <fieldset>
                    <legend>Delivery Address</legend>
                    <mat-form-field appearance="fill">
                        <mat-label>Delivery address</mat-label>
                        <mat-select formControlName="address" id="address" (selectionChange)="loadAddressDetail($event.value)" required>
                            <mat-option *ngFor="let address of addresses" [value]="address.id">
                                {{address.description}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="hasError('address', 'required')"> Address is required </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>Zip Code</mat-label>
                        <input matInput type="text" placeholder="Zip Code" formControlName="zipCode" id="zipCode" required>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>City</mat-label>
                        <input matInput type="text" placeholder="City" formControlName="city" id="city" required>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>Country</mat-label>
                        <input matInput type="text" placeholder="Country" formControlName="country" id="country" required>
                    </mat-form-field>
                </fieldset>

                <fieldset>
                    <legend>Options</legend>
                    <mat-form-field appearance="fill">
                        <mat-label>Status</mat-label>
                        <mat-select formControlName="status" id="status" required>
                            <mat-option *ngFor="let status of statusOptions" [value]="status.id">
                                {{status.name}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="hasError('status', 'required')"> Status is required </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>Priority</mat-label>
                        <mat-select formControlName="priority" id="priority" required>
                            <mat-option *ngFor="let priority of priorityOptions" [value]="priority.id">
                                {{priority.name}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="hasError('priority', 'required')"> Priority is required </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="fill">
                        <mat-label>IVA</mat-label>
                        <input matInput type="number" placeholder="IVA" formControlName="iva" id="iva" required>
                        <mat-error *ngIf="hasError('iva', 'required')">IVA is required</mat-error>
                    </mat-form-field>
                </fieldset>

                <fieldset>
                    <legend>Order Items</legend>
                    <app-order-order-item-list (newItemsEvent)="addItems($event)">
                    </app-order-order-item-list>
                </fieldset>

            </mat-card-content>
            <mat-card-actions>
                <button mat-raised-button color="primary" [disabled]="!orderForm.valid">Create</button>
                <button type="button" mat-raised-button color="warn" (click)="onCancel()">Cancel</button>
            </mat-card-actions>
        </form>
    </mat-card>
</section>